<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Cart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .cart-container {
      max-width: 600px;
      margin: 20px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .cart-header {
      background: #007bff;
      color: white;
      padding: 15px;
      border-radius: 10px 10px 0 0;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
    }
    .btn-whatsapp {
      background: #25D366;
      color: white;
      font-weight: bold;
    }
    .btn-whatsapp:hover {
      background: #1ebe5b;
      color: white;
    }
    .form-control {
      margin-bottom: 12px;
    }
  </style>
</head>
<body>

<div class="cart-container">
  <div class="cart-header">
    ğŸ›’ Your Cart
  </div>
  <button onclick="window.location.href='index.html'" class="btn btn-warning w-100 my-3">â† Back to Shop</button>

  <div id="cart-items"></div>
  <h5 class="mt-3">Total: â‚¹<span id="total-amount">0</span></h5>

  <h5 class="mt-4">ğŸ“ Customer Details</h5>
  <input type="text" id="customerName" class="form-control" placeholder="Enter your name">
  <input type="text" id="customerPhone" class="form-control" placeholder="Enter your mobile number">
  <textarea id="customerAddress" class="form-control" placeholder="Enter your full address"></textarea>

  <!-- GPS Location Button -->
  <button class="btn btn-info w-100 mb-2" onclick="getLocation()">ğŸ“ Use My Current Location</button>

  <button class="btn btn-whatsapp w-100 mt-2" onclick="placeOrder()">ğŸ“² Place Order on WhatsApp</button>
</div>

<script>
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  function renderCart() {
    let cartItemsContainer = document.getElementById("cart-items");
    let totalAmount = 0;
    cartItemsContainer.innerHTML = "";

    cart.forEach(item => {
      let itemTotal = item.price * item.quantity;
      totalAmount += itemTotal;
      cartItemsContainer.innerHTML += `
        <div class="card p-2 my-2">
          ${item.quantity} x ${item.name} = â‚¹${itemTotal}
        </div>
      `;
    });

    document.getElementById("total-amount").innerText = totalAmount;
  }

  function placeOrder() {
    let name = document.getElementById("customerName").value;
    let phone = document.getElementById("customerPhone").value;
    let address = document.getElementById("customerAddress").value;

    if (!name || !phone || !address) {
      alert("Please fill all customer details.");
      return;
    }

    let orderText = `ğŸ›’ New Order\n\nğŸ‘¤ Name: ${name}\nğŸ“ Phone: ${phone}\nğŸ  Address: ${address}\n\n`;

    let totalAmount = 0;
    cart.forEach(item => {
      let itemTotal = item.price * item.quantity;
      totalAmount += itemTotal;
      orderText += `${item.quantity} x ${item.name} = â‚¹${itemTotal}\n`;
    });

    orderText += `\nğŸ’° Total: â‚¹${totalAmount}`;

    let whatsappNumber = "7093242271"; // <-- Apna WhatsApp number
    let whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(orderText)}`;
    window.open(whatsappURL, "_blank");
  }

  // ğŸ“ Get User Location
  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else {
      alert("Geolocation is not supported by this browser.");
    }
  }

  function showPosition(position) {
    let lat = position.coords.latitude;
    let long = position.coords.longitude;
    let mapsLink = `https://www.google.com/maps?q=${lat},${long}`;
    document.getElementById("customerAddress").value += `\nğŸ“ Location: ${mapsLink}`;
  }

  function showError(error) {
    alert("Unable to fetch location. Please allow GPS access.");
  }

  renderCart();
</script>

</body>
</html>
